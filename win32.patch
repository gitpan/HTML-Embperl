
  1.13      +2 -1      modperl/src/modules/perl/mod_perl.c
  
  Index: mod_perl.c
  ===================================================================
  RCS file: /export/home/cvs/modperl/src/modules/perl/mod_perl.c,v
  retrieving revision 1.12
  retrieving revision 1.13
  diff -u -r1.12 -r1.13
  --- mod_perl.c	1998/04/21 11:02:14	1.12
  +++ mod_perl.c	1998/04/23 05:14:40	1.13
  @@ -748,7 +748,6 @@
   
   void mod_perl_end_cleanup(void *data)
   {
  -    (void)acquire_mutex(mod_perl_mutex); 
       MP_TRACE_g(fprintf(stderr, "perl_end_cleanup..."));
   
       /* clear %ENV */
  @@ -1008,6 +1007,8 @@
   	mod_perl_pass_env(r->pool, cls);
       }
   
  +    /* will be released in mod_perl_end_cleanup */
  +    (void)acquire_mutex(mod_perl_mutex); 
       register_cleanup(r->pool, NULL, mod_perl_end_cleanup, mod_perl_noop);
   
       /* hookup stderr to error_log */
  
